<!DOCTYPE html>
<html lang="kr">
	<head>
		<meta charset="UTF-8">
		<title>Insert title here</title>
		<style type="text/css">
			#topdiv{
				height: 50px;
				line-height: 50px;
				text-align: center;
				background-color: silver;
			}
			#middlediv, #bottomdiv, textarea {
/* 				height: 400px; */
				width: 100%; 
			}
			button {
				background-color: blue;
				color: white;
				border-radius: 10px;
			}
			#imgdiv {
				width: 100%;
				height: 10px;
/* 				position: relative; */
			}
			#bottomdiv{
 			position: relative; 
			}
		</style>
	</head>
	<body>
		<div id="topdiv">
			<input type="file" id="attachFile" multiple="multiple"> 
			<button type="button" onclick="readfile()">읽기</button>
		</div>
		<div id="middlediv">
			<h2>결과 출력(FileReader 객체)</h2>
			<p>이미지파일일 경우에는 DataURL형식으로 아닌경우 Text형식으로</p>
			<textarea style="height: 300px" id="result"></textarea> 
		</div>
		<div id="bottomdiv">
			<h2>파일 정보(File객체)</h2>
			<p>
				이미지 파일을 읽은 경우에 이미지가 표시된다
				다른 파일을 읽었을 경우 이미지가 표시되지 않는다.
			</p>
		<div id="imgdiv">
		</div>
			<textarea style="height: 300px" id="result2"></textarea>
		</div>
	</body>
	<script type="text/javascript">
		function readfile(){
			var files = document.getElementById("attachFile").files;
			
			if(files.length<1){
				alert("선택된 파일이 없습니다.");
				return
			}
			
			var file = files[0];
			var imgdivObj = document.getElementById("imgdiv");
			if(imgdivObj.children.length > 0) {
				imgdivObj.children[0].remove();
				imgdivObj.style.height = "10px";
			}
			
			// file.type : image/jpeg
			var reader = new FileReader();
			if(file.type.match("image.*")){ // 이미지인 경우 dataurl형식으로 반환
				// file.type.match('image.*')
				// file.type.substr(0,5) == "image"
				reader.readAsDataURL(file);
// 				document.getElementById("imgdiv").innerHTML = reader.result;
			} else {
				reader.readAsText(file);
			}
			
			var str="";
			str += "파일명 : "+ file.name+"\n"; 
			str += "파일크기 : "+file.size+"\n"; 
			str += "파일종류 : "+file.type+"\n"; 
			str += "변경날짜 : "+file.lastModifiedData+"\n";
			
			document.getElementById("result2").innerHTML = str;
			
			
			reader.onload = function(){
				document.getElementById("result").innerHTML = reader.result;
				if(file.type.substr(0,5) == "image"){
					var imgObj;
					imgObj = document.createElement("img");
					imgObj.src = reader.result;
// 					imgObj.style.height = "400px";
					imgObj.style.display = "inline";
// 					imgObj.position = "relative";
// 					imgdivObj.style.height = "400px";
					imgdivObj.appendChild(imgObj);
				}
			}
		}
	</script>
</html>